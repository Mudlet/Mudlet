name: Pull request

on:
  pull_request_target:
  pull_request:

jobs:
  add-milestone:
    runs-on: ubuntu-20.04
    permissions:
      pull-requests: write

    steps:
    - uses: actions/checkout@v2

    - name: Get next milestone
      id: next-milestone
      uses: mikefarah/yq@master
      with:
        cmd: yq eval '.milestones.next-milestone' '.github/repo-metadata.yml'

    - name: Assign PR to milestone
      uses: zoispag/action-assign-milestone@v1
      with:
        repo-token: "${{ secrets.GITHUB_TOKEN }}"
        milestone: "${{ steps.next-milestone.outputs.result }}"
